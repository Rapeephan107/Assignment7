---
title: "quiz"
author: "Rapeephan"
date: "2/17/2021"
output: html_document
---

# question7

## Install package
```{r, message=FALSE, results='hide'}
BiocManager::install("Biobase")
library(Biobase)
```

## Download data
```{r, message=FALSE, results='hide'}
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bodymap_eset.RData")
load(file=con)
close(con)
bm = bodymap.eset
edata = exprs(bm)
```

##Solotion and anser
```{r, message=FALSE, results='hide'}
row_sums = rowSums(edata)
edata7 = edata[order(-row_sums),]
index = 1:500
heatmap(edata7[index,],Rowv=NA,Colv=NA)

```

#question8

##Install package
```{r, message=FALSE, results='hide'}
BiocManager::install("DESeq2")
library(DESeq2)
```
##download data
```{r echo=FALSE, message=FALSE, results='hide'}
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bodymap_eset.RData")
load(file=con)
close(con)
bm = bodymap.eset
pdata = pData(bm)
edata = exprs(bm)
```

##solution
###log2 tranformation
```{r log2 transform, message=FALSE, results='hide'}
mm = log2(edata[,1]+1) - log2(edata[,2]+1)
aa = log2(edata[,1]+1) + log2(edata[,2]+1)
plot(aa,mm,col=3)
```

###rlog transformation
```{r, echo=FALSE, message=FALSE, results='hide'}
library(DESeq2)
edatar<-rlog(edata)

mmm = (edatar[,1])-(edatar[,2])
aaa = (edatar[,1])+(edatar[,2])
plot(aaa,mmm,col= 3)

```




##question9
###download data

##Install package
```{r, message=FALSE, results='hide'}
install.packages("rafalib",repos = "http://cran.us.r-project.org")
library(rafalib)
```

```{r, message=FALSE, results='hide'}
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/montpick_eset.RData")
load(file=con)
close(con)
mp = montpick.eset
pdata=pData(mp)
edata=as.data.frame(exprs(mp))
fdata = fData(mp)
```



##clustering with no changes to the data 
```{r, message=FALSE, results='hide'}
dist1 = dist(t(edata))
hclust1 = hclust(dist1)
plot(hclust1,hang=-1)
```
 
##clustering with after filtering all genes with rowMeans less than 100
```{r , message=FALSE, results='hide'}
edata2 = edata[rowMeans(edata) < 100,] #rowMeans less than 100
dist2 = dist(t(edata2))
hclust2 = hclust(dist2)
plot(hclust2,hang=-1)

```

##clusterin after taking the log2 transform of the data without filtering
```{r, message=FALSE, results='hide'}
edata3 = log2(edata+1)
dist3 = dist(t(edata3))
hclust3 = hclust(dist3)
plot(hclust3,hang=-1)
```


##question10

##download data
```{r echo=FALSE, message=FALSE, results='hide'}
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/montpick_eset.RData")
load(file=con)
close(con)
mp = montpick.eset
pdata=pData(mp)
edata=as.data.frame(exprs(mp))
fdata = fData(mp)
```




kmeans1 = kmeans(edata,centers=3) #3cluster
names(kmeans1)
matplot(t(kmeans1$centers),col=1:3,type="l",lwd=3)
kmeans1$cluster[1:10] #see which cluster is gene belong to 
table(kmeans1$cluster) #see how many gene in each cluster

heatmap(as.matrix(edata)[order(kmeans1$cluster),],col=colramp,Colv=NA,Rowv=NA)
kmeans2 = kmeans(edata,centers=3)
table(kmeans1$cluster,kmeans2$cluster)
